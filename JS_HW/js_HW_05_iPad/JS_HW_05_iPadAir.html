<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">

    <title>iPadAir</title>
</head>

<body>

    <div class="container">
        <div class="row">
            <div class="col-12" id="finalpriceCol"></div>
        </div>
        <div class="row">
            <div class="col-12 col-md-6 d-flex align-items-center justify-content-center" id="imgCol">
                <!-- 圖片 -->
                <!-- 下方說明 -->
            </div>

            <div class="col-12 col-md-6" id="chooseCol">
                <!-- 大標購買ipad air -->
                <!-- 外觀 顏色 -->
                <!-- 儲存裝置 容量 -->
                <!-- 連線能力 網路 -->
                <!-- 價格 -->
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous">
    </script>

    <script type="module">
        import {$g,$c} from './myhelpers.js';


        //iPadAirJSON網址
        const iPadAirUrl =
            "https://raw.githubusercontent.com/Girro39/Girro39.github.io/main/JS_HW/js_HW_05_iPad/iPadAir202009.json";

        let iPadAirXHR = new XMLHttpRequest();
        let iPadAirObject;
        let btnShowiPadAir = $g('#showipadair');
        let chooseCol = $g('#chooseCol');
        let imgCol = $g('#imgCol');
        let ipadimg = $c('img','ipadimg');
        
        window.onload = function () {
            requestiPadAirJson();
        }
        

        function requestiPadAirJson() {
            iPadAirXHR.onload = function () {
                iPadAirObject = JSON.parse(this.responseText);
                showiPadAir();
            }
            iPadAirXHR.open('GET', iPadAirUrl);
            iPadAirXHR.send();
        }

            // btnShowiPadAir.addEventListener('click',showiPadAir);

        function showiPadAir(){
            // alert('show')
            //創顏色
            createColors();
            //創圖片
            ipadimg.setAttribute('src','https://store.storeimages.cdn-apple.com/8756/as-images.apple.com/is/ipad-air-select-202009');
            imgCol.appendChild(ipadimg);
            //創容量
            createSN();
            //創網路
            //創價格            
        }
        
        function createColors(){ 
            let colorimg;
            let colorp;
            let colorbtn;
            let colorh2;
            let colorRow = $c('div','colorRow','row');
            colorh2 = $c('h2');
            colorh2.innerHTML = `外觀`;
            colorRow.appendChild(colorh2);
            iPadAirObject.colors.forEach((item)=>{
                colorimg = $c('img',`${item.enus}img`,'w-25 mx-auto');
                colorimg.setAttribute('src',`${item.colorimgurl}`);

                colorp = $c('p',`${item.enus}text`);
                colorp.innerHTML =`${item.zhtw}`;

                colorbtn = $c('div',`${item.enus}btn`,'col-4 btn btn-outline-secondary m-2');
                colorbtn.setAttribute('style','border-radius:30px;');


                colorbtn.appendChild(colorimg);
                colorbtn.appendChild(colorp);
                colorRow.appendChild(colorbtn);
                
                
                colorbtn.addEventListener('click',function(){
                    let changeipadimg = $c('img',`${item.enus}ipadimg`,'w-50 mx-auto');
                    changeipadimg.setAttribute('src',`${item.ipadimgurlWiFi}`);
                    imgCol.innerHTML = '';
                    imgCol.appendChild(changeipadimg);
                });
                
            });
            chooseCol.appendChild(colorRow);
        }

        function createSN(){
            let storageRow = $c('div','storageRow','row');
            let storageCPC,storageSP,storagebtn;

            iPadAirObject.storages.forEach((item)=>{
                storageCPC = $c('p',`${item.capacity}text`);
                storageCPC.innerHTML = `${item.capacity}`;

                storageSP = $c('p',`${item.startprice}text`);
                storageSP.innerHTML =`${item.startprice}`;

                storagebtn = $c('div',`${item.enus}btn`,'col-4 btn btn-outline-secondary m-2');
                storagebtn.setAttribute('style','border-radius:30px;');

                storagebtn.appendChild(storageCPC);
                storagebtn.appendChild(storageSP);
                storageRow.appendChild(storagebtn);

                // console.log(item.startprice);
            });

            chooseCol.appendChild(storageRow);

        }

    </script>

</body>

</html>